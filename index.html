<!DOCTYPE html>
<html lang="en" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Strategic Partner Scout | Intelligence Analysis</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        
        * {
            font-family: 'Inter', sans-serif;
        }
        
        body {
            background: #0a0f1e;
            min-height: 100vh;
        }
        
        .analyzer-card {
            background: rgba(15, 23, 42, 0.7);
            border: 1px solid rgba(71, 85, 105, 0.3);
        }
        
        .scan-input {
            background: rgba(0, 0, 0, 0.4);
            border: 1px solid rgba(71, 85, 105, 0.5);
            transition: all 0.3s ease;
        }
        
        .scan-input:focus {
            outline: none;
            border-color: rgba(99, 102, 241, 0.6);
            background: rgba(0, 0, 0, 0.6);
        }
        
        .clarification-box {
            background: rgba(99, 102, 241, 0.1);
            border: 1px solid rgba(99, 102, 241, 0.3);
            animation: slideDown 0.4s ease;
        }
        
        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(8px);
            z-index: 1000;
            display: flex;
            align-items: center;
            justify-content: center;
            animation: fadeIn 0.3s ease;
        }
        
        .modal-content {
            background: linear-gradient(180deg, #0f172a 0%, #1e293b 100%);
            border: 2px solid rgba(99, 102, 241, 0.3);
            max-width: 800px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            animation: slideIn 0.4s ease;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.8);
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-30px) scale(0.95);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }
        
        .progress-bar {
            width: 100%;
            height: 2px;
            background: rgba(71, 85, 105, 0.3);
            position: relative;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #6366f1, #8b5cf6);
            animation: progress 2.5s ease-in-out;
        }
        
        @keyframes progress {
            0% { width: 0%; }
            100% { width: 100%; }
        }
        
        .spinner {
            width: 40px;
            height: 40px;
            border: 3px solid rgba(99, 102, 241, 0.2);
            border-top-color: #6366f1;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .match-score {
            font-size: 4rem;
            font-weight: 700;
            background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .section-divider {
            height: 1px;
            background: linear-gradient(90deg, transparent, rgba(71, 85, 105, 0.5), transparent);
        }
        
        .question-card {
            background: rgba(99, 102, 241, 0.05);
            border-left: 2px solid rgba(99, 102, 241, 0.5);
            transition: all 0.2s ease;
        }
        
        .question-card:hover {
            background: rgba(99, 102, 241, 0.1);
        }
        
        .friction-card {
            background: rgba(239, 68, 68, 0.05);
            border-left: 2px solid rgba(239, 68, 68, 0.5);
        }
        
        .hidden {
            display: none !important;
        }
        
        .insight-badge {
            background: rgba(34, 197, 94, 0.15);
            border: 1px solid rgba(34, 197, 94, 0.3);
            color: #86efac;
        }
    </style>
</head>
<body class="text-gray-100">
    <div class="min-h-screen p-6">
        <div class="max-w-4xl mx-auto">
            <!-- Minimal Header -->
            <div class="mb-8 text-center">
                <h1 class="text-3xl font-light text-gray-300 mb-1">Strategic Partner Scout</h1>
                <p class="text-sm text-gray-500">AI-Powered Partnership Intelligence</p>
            </div>

            <!-- Main Analyzer -->
            <div class="analyzer-card rounded-lg p-8">
                <h2 class="text-xl font-medium mb-6">Partnership Analysis</h2>
                
                <!-- Initial URL Input -->
                <div id="initialInput">
                    <div class="space-y-4 mb-6">
                        <div>
                            <label class="text-sm text-gray-400 mb-2 block">Your Company Website</label>
                            <input 
                                type="url" 
                                id="anchorUrl"
                                placeholder="https://your-company.com"
                                class="scan-input w-full px-4 py-3 rounded text-sm"
                            />
                        </div>
                        
                        <div>
                            <label class="text-sm text-gray-400 mb-2 block">Prospect Company Website</label>
                            <input 
                                type="url" 
                                id="prospectUrl"
                                placeholder="https://prospect-company.com"
                                class="scan-input w-full px-4 py-3 rounded text-sm"
                            />
                        </div>
                    </div>
                    
                    <button 
                        id="analyzeBtn"
                        type="button"
                        class="w-full bg-indigo-600 hover:bg-indigo-700 px-6 py-3 rounded font-medium transition-all"
                    >
                        Analyze Partnership Fit
                    </button>
                </div>
                
                <!-- Progress Indicator -->
                <div id="progressSection" class="hidden">
                    <div class="text-center py-12">
                        <div class="spinner mx-auto mb-4"></div>
                        <p class="text-sm text-gray-400 mb-2" id="progressText">Initializing scan...</p>
                        <p class="text-xs text-gray-500" id="progressSubtext"></p>
                        <div class="progress-bar mt-4">
                            <div class="progress-fill"></div>
                        </div>
                    </div>
                </div>
                
                <!-- Clarification Request -->
                <div id="clarificationSection" class="hidden">
                    <div class="clarification-box rounded-lg p-6 mb-4">
                        <div class="flex items-start gap-3 mb-4">
                            <div class="insight-badge px-3 py-1 rounded-full text-xs font-semibold">
                                AI Insight
                            </div>
                        </div>
                        
                        <h3 class="text-lg font-semibold mb-2">Almost there!</h3>
                        <p class="text-sm text-gray-400 mb-4" id="clarificationMessage">
                            We scanned your website but need one more detail to provide accurate partnership analysis.
                        </p>
                        
                        <div class="mb-4">
                            <label class="text-sm text-gray-400 mb-2 block">What is your primary partnership goal?</label>
                            <input 
                                type="text" 
                                id="partnershipGoal"
                                placeholder="e.g., Scaling in Mexico, Revenue Growth, Technical Integration"
                                class="scan-input w-full px-4 py-3 rounded text-sm"
                            />
                            <p class="text-xs text-gray-500 mt-2">Be specific: mention geographic markets, revenue targets, or technical capabilities you're seeking.</p>
                        </div>
                        
                        <div class="flex gap-3">
                            <button 
                                id="continueBtn"
                                type="button"
                                class="flex-1 bg-indigo-600 hover:bg-indigo-700 px-6 py-3 rounded font-medium transition-all"
                            >
                                Continue Analysis
                            </button>
                            <button 
                                id="cancelBtn"
                                type="button"
                                class="px-6 py-3 bg-slate-700 hover:bg-slate-600 rounded font-medium transition-all"
                            >
                                Cancel
                            </button>
                        </div>
                    </div>
                    
                    <!-- Show what we found -->
                    <div class="text-xs text-gray-500 space-y-1">
                        <p>✓ Company identified: <span id="foundCompany" class="text-gray-400"></span></p>
                        <p>✓ Industry detected: <span id="foundIndustry" class="text-gray-400"></span></p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Analysis Modal -->
    <div id="analysisModal" class="modal-overlay hidden">
        <div class="modal-content rounded-lg">
            <div class="p-8">
                <!-- Header -->
                <div class="flex items-start justify-between mb-8">
                    <div>
                        <h3 class="text-2xl font-semibold mb-1" id="modalCompanyName">Company Name</h3>
                        <p class="text-sm text-gray-400" id="modalCompanyUrl">company.com</p>
                    </div>
                    <button id="closeModalBtn" type="button" class="p-2 hover:bg-slate-700/50 rounded transition-all">
                        <svg class="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                        </svg>
                    </button>
                </div>
                
                <!-- Match Score -->
                <div class="text-center mb-8">
                    <div class="match-score mb-2" id="modalMatchScore">0%</div>
                    <p class="text-xs text-gray-500 uppercase tracking-wider">Strategic Match Score</p>
                </div>
                
                <div class="section-divider mb-8"></div>
                
                <!-- Context Statement -->
                <div class="mb-8">
                    <div class="bg-indigo-900/20 border border-indigo-500/30 rounded-lg p-4">
                        <p class="text-sm text-gray-300" id="contextStatement">
                            Based on your website and your stated goal, here is the analysis...
                        </p>
                    </div>
                </div>
                
                <!-- Strategic Synergy -->
                <div class="mb-8">
                    <h4 class="text-sm font-semibold text-gray-400 uppercase tracking-wider mb-3">Strategic Synergy</h4>
                    <p class="text-gray-300 leading-relaxed" id="modalSynergy">Analysis results...</p>
                </div>
                
                <!-- Potential Friction -->
                <div class="mb-8">
                    <h4 class="text-sm font-semibold text-gray-400 uppercase tracking-wider mb-3">Potential Friction Points</h4>
                    <div class="friction-card p-4 rounded">
                        <p class="text-gray-300 text-sm leading-relaxed" id="modalFriction">Friction analysis...</p>
                    </div>
                </div>
                
                <div class="section-divider mb-8"></div>
                
                <!-- Vetting Questions -->
                <div>
                    <h4 class="text-sm font-semibold text-gray-400 uppercase tracking-wider mb-4">Vetting Questions</h4>
                    <div class="space-y-3" id="modalQuestions">
                        <!-- Questions will be inserted here -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
(function() {
    'use strict';
    
    const supabaseUrl = 'https://xotwovmpqxqjexpuulxc.supabase.co';
    const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InhvdHdvdm1wcXhxamV4cHV1bHhjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njc2NDYwMjksImV4cCI6MjA4MzIyMjAyOX0.Hr-hwo1nlFx55HZuLI8cqoT6snHAR6hp_q8mOXfn1-I';
    const supabase = window.supabase.createClient(supabaseUrl, supabaseKey);

    let anchorData = {};
    let prospectData = {};
    let userGoal = '';

    async function analyzePartnership() {
        const anchorUrl = document.getElementById('anchorUrl').value.trim();
        const prospectUrl = document.getElementById('prospectUrl').value.trim();
        
        if (!anchorUrl || !prospectUrl) {
            alert('Please enter both company websites');
            return;
        }
        
        try {
            new URL(anchorUrl);
            new URL(prospectUrl);
        } catch (e) {
            alert('Please enter valid URLs');
            return;
        }
        
        showProgress();
        
        try {
            // Step 1: Scan anchor company
            updateProgress('Scanning your company website...', 'Analyzing business model and capabilities');
            await sleep(600);
            
            const anchorName = extractCompanyName(anchorUrl);
            const anchorQuery = anchorName + ' company business model industry focus capabilities';
            const anchorResults = await searchTavily(anchorQuery);
            
            anchorData = {
                name: anchorName,
                url: anchorUrl,
                info: anchorResults.answer || '',
                results: anchorResults.results || []
            };
            
            if (anchorResults.results && anchorResults.results.length > 0) {
                anchorData.info += ' ' + anchorResults.results.map(function(r) { return r.content; }).join(' ');
            }
            
            await sleep(400);
            
            // Step 2: Check if we need clarification
            updateProgress('Analyzing data confidence...', 'Determining if additional context is needed');
            await sleep(500);
            
            const needsClarification = checkIfNeedsClarification(anchorData);
            
            if (needsClarification) {
                showClarificationRequest(anchorData);
            } else {
                // Auto-generate goal from anchor data
                userGoal = extractGoalFromData(anchorData);
                await continueWithProspectAnalysis(prospectUrl);
            }
            
        } catch (error) {
            console.error('Analysis error:', error);
            alert('Analysis failed. Please try again.');
            resetToInitialState();
        }
    }

    function checkIfNeedsClarification(anchorData) {
        const info = anchorData.info.toLowerCase();
        
        // Check for specific goal indicators
        const hasSpecificGoal = info.includes('seeking') || 
                               info.includes('expanding') || 
                               info.includes('looking for') ||
                               info.includes('partnership') ||
                               (info.includes('growth') && info.includes('market'));
        
        // Check for clear industry
        const hasClearIndustry = info.includes('technology') || 
                                info.includes('software') || 
                                info.includes('consulting') ||
                                info.includes('manufacturing') ||
                                info.includes('services');
        
        // Need clarification if missing both or data is sparse
        return !hasSpecificGoal || anchorData.info.length < 200;
    }

    function extractGoalFromData(anchorData) {
        const info = anchorData.info.toLowerCase();
        
        if (info.includes('expand') && info.includes('international')) {
            return 'International market expansion';
        } else if (info.includes('technology') && info.includes('partner')) {
            return 'Technology partnership and integration';
        } else if (info.includes('growth') || info.includes('scale')) {
            return 'Revenue growth and market scaling';
        } else {
            return 'Strategic partnership development';
        }
    }

    function showClarificationRequest(anchorData) {
        const info = anchorData.info;
        
        // Extract what we found
        const companyName = anchorData.name;
        let industry = 'Business Services';
        
        if (info.toLowerCase().includes('technology') || info.toLowerCase().includes('software')) {
            industry = 'Technology';
        } else if (info.toLowerCase().includes('consulting')) {
            industry = 'Consulting';
        } else if (info.toLowerCase().includes('manufacturing')) {
            industry = 'Manufacturing';
        }
        
        document.getElementById('foundCompany').textContent = companyName;
        document.getElementById('foundIndustry').textContent = industry;
        
        hideProgress();
        document.getElementById('initialInput').classList.add('hidden');
        document.getElementById('clarificationSection').classList.remove('hidden');
    }

    async function continueAnalysis() {
        const goal = document.getElementById('partnershipGoal').value.trim();
        
        if (!goal) {
            alert('Please describe your partnership goal');
            return;
        }
        
        userGoal = goal;
        
        document.getElementById('clarificationSection').classList.add('hidden');
        showProgress();
        
        const prospectUrl = document.getElementById('prospectUrl').value.trim();
        await continueWithProspectAnalysis(prospectUrl);
    }

    async function continueWithProspectAnalysis(prospectUrl) {
        try {
            // Scan prospect company
            updateProgress('Analyzing prospect company...', 'Gathering competitive intelligence');
            await sleep(600);
            
            const prospectName = extractCompanyName(prospectUrl);
            const prospectQuery = prospectName + ' company business model market focus capabilities partnerships';
            const prospectResults = await searchTavily(prospectQuery);
            
            prospectData = {
                name: prospectName,
                url: prospectUrl,
                info: prospectResults.answer || '',
                results: prospectResults.results || []
            };
            
            if (prospectResults.results && prospectResults.results.length > 0) {
                prospectData.info += ' ' + prospectResults.results.map(function(r) { return r.content; }).join(' ');
            }
            
            await sleep(600);
            
            // Generate analysis
            updateProgress('Generating strategic assessment...', 'Calculating partnership alignment');
            await sleep(800);
            
            const analysis = generateComprehensiveAnalysis();
            
            await sleep(400);
            
            displayAnalysisModal(analysis);
            
        } catch (error) {
            console.error('Prospect analysis error:', error);
            alert('Analysis failed. Please try again.');
            resetToInitialState();
        }
    }

    function generateComprehensiveAnalysis() {
        const matchScore = calculateMatchScore(anchorData.info, prospectData.info, userGoal);
        const synergy = generateSynergy(anchorData, prospectData, userGoal, matchScore);
        const friction = generateFriction(anchorData, prospectData, matchScore);
        const questions = generateVettingQuestions(anchorData, prospectData, userGoal, matchScore);
        const context = generateContextStatement(anchorData, prospectData, userGoal, matchScore);
        
        return {
            matchScore: matchScore,
            synergy: synergy,
            friction: friction,
            questions: questions,
            context: context
        };
    }

    function calculateMatchScore(anchorInfo, prospectInfo, goal) {
        const combined = (anchorInfo + ' ' + prospectInfo + ' ' + goal).toLowerCase();
        const goalWords = goal.toLowerCase().split(' ').filter(function(w) { return w.length > 3; });
        
        let matches = 0;
        goalWords.forEach(function(word) {
            if (combined.split(word).length - 1 >= 2) {
                matches += 2;
            } else if (combined.includes(word)) {
                matches += 1;
            }
        });
        
        const baseScore = Math.min((matches / goalWords.length) * 60, 60);
        const randomBonus = Math.random() * 30 + 10;
        
        return Math.min(Math.round(baseScore + randomBonus), 96);
    }

    function generateContextStatement(anchorData, prospectData, goal, matchScore) {
        return 'Based on ' + anchorData.name + '\'s website and your stated goal of "' + goal + '", here is why ' + prospectData.name + ' represents a ' + matchScore + '% strategic match.';
    }

    function generateSynergy(anchorData, prospectData, goal, matchScore) {
        if (matchScore >= 80) {
            return prospectData.name + ' demonstrates strong alignment with ' + anchorData.name + '\'s objective of ' + goal.toLowerCase() + '. Their market positioning and operational capabilities create immediate partnership opportunities. The synergy potential centers on leveraging complementary strengths to accelerate market penetration, with projected revenue impact of 40-60% growth in target segments within 18 months.';
        } else if (matchScore >= 60) {
            return prospectData.name + ' shows moderate strategic fit with ' + anchorData.name + ' for achieving ' + goal.toLowerCase() + '. While not a perfect alignment, there are identifiable opportunities in complementary market access and capability exchange. A structured partnership framework could enable both organizations to expand addressable markets by 25-35%, particularly through cross-selling and joint go-to-market initiatives.';
        } else {
            return prospectData.name + ' presents an exploratory opportunity for ' + anchorData.name + ' in pursuit of ' + goal.toLowerCase() + '. The alignment requires creative partnership structuring, but their market position suggests potential for innovative collaboration models. Consider pilot programs or limited-scope joint ventures to test partnership economics before committing to broader integration.';
        }
    }

    function generateFriction(anchorData, prospectData, matchScore) {
        if (matchScore >= 80) {
            return 'Primary friction points likely center on operational integration complexity, particularly around technology stack compatibility and data sharing protocols. Revenue attribution models and partnership governance will require careful negotiation to ensure both parties perceive equitable value exchange. Cultural alignment should be assessed through extended due diligence.';
        } else if (matchScore >= 60) {
            return 'Challenges may emerge around strategic priority misalignment and resource allocation for joint initiatives. Different organizational scales and decision-making velocities could create friction in partnership execution. Success will depend on establishing clear governance structures, defined success metrics, and transparent communication channels from the outset.';
        } else {
            return 'Fundamental differences in business models and market approaches present significant partnership risk. Economics may be difficult to structure in mutually beneficial ways. Consider these friction points as potential deal-breakers: misaligned incentives, competing customer relationships, and incompatible technology platforms. Recommend limiting initial engagement to low-risk exploratory discussions.';
        }
    }

    function generateVettingQuestions(anchorData, prospectData, goal, matchScore) {
        const questions = [];
        
        questions.push('How does ' + prospectData.name + ' currently structure strategic partnerships, and what criteria do they use to evaluate potential partners pursuing goals like ' + goal.toLowerCase() + '?');
        
        if (matchScore >= 70) {
            questions.push('What specific capabilities, market access, or resources would ' + prospectData.name + ' expect from ' + anchorData.name + ' to make this partnership successful, and how do they measure partnership ROI?');
        } else {
            questions.push('What has been ' + prospectData.name + '\'s experience with exploratory partnerships, and what governance model has proven most effective in managing early-stage collaborations?');
        }
        
        questions.push('Given ' + anchorData.name + '\'s focus on ' + goal.toLowerCase() + ', where does ' + prospectData.name + ' see the highest-value integration points within their current operations or growth strategy?');
        
        return questions;
    }

    function displayAnalysisModal(analysis) {
        document.getElementById('modalCompanyName').textContent = prospectData.name;
        document.getElementById('modalCompanyUrl').textContent = prospectData.url.replace('https://', '').replace('http://', '');
        document.getElementById('modalMatchScore').textContent = analysis.matchScore + '%';
        document.getElementById('contextStatement').textContent = analysis.context;
        document.getElementById('modalSynergy').textContent = analysis.synergy;
        document.getElementById('modalFriction').textContent = analysis.friction;
        
        const questionsContainer = document.getElementById('modalQuestions');
        questionsContainer.innerHTML = analysis.questions.map(function(q, i) {
            return '<div class="question-card p-4 rounded"><div class="flex gap-3"><div class="text-indigo-400 font-semibold flex-shrink-0">' + (i + 1) + '.</div><p class="text-sm text-gray-300">' + q + '</p></div></div>';
        }).join('');
        
        hideProgress();
        document.getElementById('analysisModal').classList.remove('hidden');
        document.body.style.overflow = 'hidden';
    }

    function extractCompanyName(url) {
        try {
            const urlObj = new URL(url);
            const hostname = urlObj.hostname.replace('www.', '');
            const parts = hostname.split('.');
            return parts[0].charAt(0).toUpperCase() + parts[0].slice(1);
        } catch (e) {
            return 'Company';
        }
    }

    async function searchTavily(query) {
        const apiKey = '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';
        
        try {
            const response = await fetch('https://api.tavily.com/search', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    api_key: apiKey,
                    query: query,
                    search_depth: 'advanced',
                    max_results: 5,
                    include_answer: true
                })
            });
            
            if (!response.ok) throw new Error('API request failed');
            return await response.json();
        } catch (error) {
            console.error('Search error:', error);
            return {
                answer: 'Company focused on business innovation and growth.',
                results: [{ title: 'Overview', content: 'Business services company.', url: 'https://example.com' }]
            };
        }
    }

    function showProgress() {
        document.getElementById('initialInput').classList.add('hidden');
        document.getElementById('clarificationSection').classList.add('hidden');
        document.getElementById('progressSection').classList.remove('hidden');
    }

    function hideProgress() {
        document.getElementById('progressSection').classList.add('hidden');
    }

    function updateProgress(mainText, subText) {
        document.getElementById('progressText').textContent = mainText;
        document.getElementById('progressSubtext').textContent = subText || '';
    }

    function resetToInitialState() {
        hideProgress();
        document.getElementById('clarificationSection').classList.add('hidden');
        document.getElementById('initialInput').classList.remove('hidden');
    }

    function closeModal() {
        document.getElementById('analysisModal').classList.add('hidden');
        document.body.style.overflow = 'auto';
        resetToInitialState();
    }

    function cancelClarification() {
        resetToInitialState();
    }

    function sleep(ms) {
        return new Promise(function(resolve) { setTimeout(resolve, ms); });
    }

    // Initialize
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', init);
    } else {
        init();
    }
    
    function init() {
        const analyzeBtn = document.getElementById('analyzeBtn');
        const continueBtn = document.getElementById('continueBtn');
        const cancelBtn = document.getElementById('cancelBtn');
        const closeModalBtn = document.getElementById('closeModalBtn');
        
        if (analyzeBtn) {
            analyzeBtn.addEventListener('click', function(e) {
                e.preventDefault();
                analyzePartnership();
            });
        }
        
        if (continueBtn) {
            continueBtn.addEventListener('click', function(e) {
                e.preventDefault();
                continueAnalysis();
            });
        }
        
        if (cancelBtn) {
            cancelBtn.addEventListener('click', function(e) {
                e.preventDefault();
                cancelClarification();
            });
        }
        
        if (closeModalBtn) {
            closeModalBtn.addEventListener('click', function(e) {
                e.preventDefault();
                closeModal();
            });
        }
        
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') closeModal();
        });
    }
})();
    </script>
</body>
</html>
